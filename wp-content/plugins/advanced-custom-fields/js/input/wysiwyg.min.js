(function($){var _wysiwyg=acf.fields.wysiwyg={$el:null,$textarea:null,o:{},set:function(o){$.extend(this,o);this.$textarea=this.$el.find("textarea");this.o=acf.helpers.get_atts(this.$el);this.o.id=this.$textarea.attr("id");return this},has_tinymce:function(){var r=false;if(typeof tinyMCE=="object"){r=true}return r},get_toolbar:function(){if(acf.helpers.isset(this,"toolbars",this.o.toolbar)){return this.toolbars[this.o.toolbar]}return false},init:function(){if(acf.helpers.is_clone_field(this.$textarea)){return}var id=this.o.id,toolbar=this.get_toolbar(),command="mceAddControl",setting="theme_advanced_buttons{i}";var _settings=$.extend({},tinyMCE.settings);if(tinymce.majorVersion==4){command="mceAddEditor";setting="toolbar{i}"}if(toolbar){for(var i=1;i<5;i++){var v="";if(acf.helpers.isset(toolbar,"theme_advanced_buttons"+i)){v=toolbar["theme_advanced_buttons"+i]}tinyMCE.settings[setting.replace("{i}",i)]=v}}tinyMCE.execCommand(command,false,id);$(document).trigger("acf/wysiwyg/load",id);setTimeout(function(){_wysiwyg.add_events(id)},100);tinyMCE.settings=_settings;wpActiveEditor=null},add_events:function(id){var editor=tinyMCE.get(id);if(!editor)return;var $container=$("#wp-"+id+"-wrap"),$body=$(editor.getBody());$container.on("click",function(){$(document).trigger("acf/wysiwyg/click",id)});$body.on("focus",function(){$(document).trigger("acf/wysiwyg/focus",id)});$body.on("blur",function(){$(document).trigger("acf/wysiwyg/blur",id)})},destroy:function(){var id=this.o.id,command="mceRemoveControl";try{var editor=tinyMCE.get(id);if(!editor){return}if(tinymce.majorVersion==4){command="mceRemoveEditor"}var val=editor.getContent();tinyMCE.execCommand(command,false,id);this.$textarea.val(val)}catch(e){}wpActiveEditor=null}};$(document).on("acf/setup_fields",function(e,el){if(!_wysiwyg.has_tinymce()){return}$(el).find(".acf_wysiwyg").each(function(){_wysiwyg.set({$el:$(this)}).destroy()});setTimeout(function(){$(el).find(".acf_wysiwyg").each(function(){_wysiwyg.set({$el:$(this)}).init()})},0)});$(document).on("acf/remove_fields",function(e,$el){if(!_wysiwyg.has_tinymce()){return}$el.find(".acf_wysiwyg").each(function(){_wysiwyg.set({$el:$(this)}).destroy()})});$(document).on("acf/wysiwyg/click",function(e,id){wpActiveEditor=id;container=$("#wp-"+id+"-wrap").closest(".field").removeClass("error")});$(document).on("acf/wysiwyg/focus",function(e,id){wpActiveEditor=id;container=$("#wp-"+id+"-wrap").closest(".field").removeClass("error")});$(document).on("acf/wysiwyg/blur",function(e,id){wpActiveEditor=null;var editor=tinyMCE.get(id);if(!editor){return}var el=editor.getElement();editor.save();$(el).trigger("change")});$(document).on("acf/sortable_start",function(e,el){if(!_wysiwyg.has_tinymce()){return}$(el).find(".acf_wysiwyg").each(function(){_wysiwyg.set({$el:$(this)}).destroy()})});$(document).on("acf/sortable_stop",function(e,el){if(!_wysiwyg.has_tinymce()){return}$(el).find(".acf_wysiwyg").each(function(){_wysiwyg.set({$el:$(this)}).init()})});$(window).on("load",function(){if(!_wysiwyg.has_tinymce()){return}var wp_content=$("#wp-content-wrap").exists(),wp_acf_settings=$("#wp-acf_settings-wrap").exists();mode="tmce";if(wp_acf_settings){if($("#wp-acf_settings-wrap").hasClass("html-active")){mode="html"}}setTimeout(function(){if(wp_acf_settings&&mode=="html"){$("#acf_settings-tmce").trigger("click")}},1);setTimeout(function(){if(wp_acf_settings&&mode=="html"){$("#acf_settings-html").trigger("click")}if(wp_content){_wysiwyg.add_events("content")}},11)});$(document).on("click",".acf_wysiwyg a.mce_fullscreen",function(){var wysiwyg=$(this).closest(".acf_wysiwyg"),upload=wysiwyg.attr("data-upload");if(upload=="no"){$("#mce_fullscreen_container td.mceToolbar .mce_add_media").remove()}})})(jQuery);